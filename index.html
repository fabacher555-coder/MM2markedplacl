<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <title>MM2 Market â€” Demo</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- NEU: PayPal SDK -->
  <script src="https://www.paypal.com/sdk/js?client-id=AZLjLoylhP8trchxDw9BolwD2rlIzZVbYyBCbAvgtZ8r2ndbmc49l4RXlBChcNJ9Prx2Jf5_RnsdnEz_&currency=USD"></script>

  <style>
    body { font-family: Arial, sans-serif; background:#f5f5f5; margin:0; padding:20px; }
    .wallet { margin-bottom:20px; padding:12px; background:white; border-radius:6px; }
    .btn { background:#0070ba; color:white; border:none; padding:10px 16px; border-radius:6px; cursor:pointer; }
    .btn:hover { background:#005c99; }
    .paypal-box { margin-top:16px; padding:12px; background:white; border-radius:6px; }
  </style>
</head>
<body>

  <h1>MM2 Market (Demo)</h1>

  <div class="wallet">
    Dein Guthaben: <strong id="wallet">$0.00</strong>
  </div>

  <!-- NEU: PayPal Guthaben-Aufladen -->
  <div class="paypal-box">
    <h3>Wallet aufladen</h3>
    <input id="amountInput" type="number" min="1" step="1" placeholder="Betrag in $" style="padding:6px" />
    <div id="paypal-button-container" style="margin-top:12px; min-height:44px"></div>
  </div>

  <script>
    let wallet = 0;

    function updateWallet(){
      document.getElementById('wallet').textContent = "$" + wallet.toFixed(2);
    }

    // NEU: PayPal Buttons rendern
    paypal.Buttons({
      style: { color: 'blue', shape: 'rect', label: 'paypal' },
      createOrder: function(data, actions) {
        const amt = parseFloat(document.getElementById("amountInput").value || 0);
        if(!amt || amt <= 0){
          alert("Bitte gib einen Betrag > 0 ein.");
          return;
        }
        return actions.order.create({
          purchase_units: [{ amount: { value: amt.toString() } }]
        });
      },
      onApprove: function(data, actions) {
        return actions.order.capture().then(function(details) {
          const amt = parseFloat(document.getElementById("amountInput").value || 0);
          wallet += amt;
          updateWallet();
          alert("Zahlung erfolgreich von " + details.payer.name.given_name + ". Wallet +$" + amt.toFixed(2));
        });
      },
      onError: function(err) {
        console.error("PayPal Fehler:", err);
        alert("Fehler bei der PayPal-Zahlung");
      }
    }).render('#paypal-button-container');

    updateWallet();
  </script>
</body>
</html>
