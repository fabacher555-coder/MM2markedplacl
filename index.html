<!-- PayPal SDK -->
<script src="https://www.paypal.com/sdk/js?client-id=AZLjLoylhP8trchxDw9BolwD2rlIzZVbYyBCbAvgtZ8r2ndbmc49l4RXlBChcNJ9Prx2Jf5_RnsdnEz_&currency=USD"></script>

<!-- Modal Guthaben -->
<div id="modalTopup" class="modal">
  <div class="modal-card">
    <h3>Guthaben aufladen</h3>
    <p class="small">Bezahlen mit PayPal:</p>
    <div id="paypal-button-container"></div>
    <div style="margin-top:8px;text-align:right">
      <button class="secondary" onclick="closeTopup()">Schließen</button>
    </div>
  </div>
</div>

<script>
function showTopup(){
  document.getElementById('modalTopup').classList.add('open');
  renderPayPalButton(10);
}

function closeTopup(){
  document.getElementById('modalTopup').classList.remove('open');
}

function renderPayPalButton(amount){
  document.getElementById('paypal-button-container').innerHTML = "";
  paypal.Buttons({
    style: { color: 'blue', shape: 'rect', label: 'paypal' },
    createOrder: (data, actions) => {
      return actions.order.create({
        purchase_units: [{ amount: { value: amount.toString() } }]
      });
    },
    onApprove: (data, actions) => {
      return actions.order.capture().then(details => {
        wallet += amount;
        saveAll();
        document.getElementById('wallet').textContent = wallet.toFixed(2);
        closeTopup();
      });
    },
    onError: (err) => {
      console.log("PayPal Fehler:", err);
      // Fehler werden nur still im Log angezeigt, keine Popups
    }
  }).render('#paypal-button-container');
}
</script>
<!-- PayPal SDK -->
<script src="https://www.paypal.com/sdk/js?client-id=AZLjLoylhP8trchxDw9BolwD2rlIzZVbYyBCbAvgtZ8r2ndbmc49l4RXlBChcNJ9Prx2Jf5_RnsdnEz_&currency=USD"></script>

<!-- Modal Guthaben -->
<div id="modalTopup" class="modal">
  <div class="modal-card">
    <h3>Guthaben aufladen</h3>
    <p class="small">Bezahlen mit PayPal:</p>
    <div id="paypal-button-container"></div>
    <div style="margin-top:8px;text-align:right">
      <button class="secondary" onclick="closeTopup()">Schließen</button>
    </div>
  </div>
</div>

<script>
function showTopup(){
  document.getElementById('modalTopup').classList.add('open');
  renderPayPalButton(10);
}

function closeTopup(){
  document.getElementById('modalTopup').classList.remove('open');
}

function renderPayPalButton(amount){
  document.getElementById('paypal-button-container').innerHTML = "";
  paypal.Buttons({
    style: { color: 'blue', shape: 'rect', label: 'paypal' },
    createOrder: (data, actions) => {
      return actions.order.create({
        purchase_units: [{ amount: { value: amount.toString() } }]
      });
    },
    onApprove: (data, actions) => {
      return actions.order.capture().then(details => {
        wallet += amount;
        saveAll();
        document.getElementById('wallet').textContent = wallet.toFixed(2);
        closeTopup();
      });
    },
    onError: (err) => {
      console.log("PayPal Fehler:", err);
      // Fehler werden nur still im Log angezeigt, keine Popups
    }
  }).render('#paypal-button-container');
}
</script>
